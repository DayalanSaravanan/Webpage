<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="generator" content="GitLab Pages">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Dayalan Saravanan</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
  </head>

  <body style="background: #ffffff;" onload="onPageLoad();">

    <header>
      <h3>Dayalan Saravanan</h3>

      <nav>
        <a href="index.html" class="current">Home</a>
        <a href="linux.html">Linux</a>
        <a href="math.html">Math</a>
        <a href="music.html">Music</a>
        <a href="numerical.html">Numerical</a>
        <a href="programming.html">Programming</a>
      </nav>
    </header>

    <hr />

    <h4>CUDA Thread Indexing Reference</h4>
    <p style="margin-top: -17px;"><small>Wednesday, November 27, 2024</small></p>

    <p>1D grid of 1D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_1D_1D() {

      int threadId = blockIdx.x * blockDim.x + threadIdx.x;

      return threadId;
    }
    </code></pre> <br>

    <p>1D grid of 2D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_1D_2D() {

      int threadId = blockIdx.x * blockDim.x * blockDim.y
                    + threadIdx.y * blockDim.x + threadId.x;

      return threadId;
    }
    </code></pre> <br>

    <p>1D grid of 3D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_1D_3D() {

      int threadId = blockIdx.x * blockDim.x * blockDim.y * blockDim.z
                    + threadIdx.z * blockDim.y * blockDim.x
                    + threadIdx.y * blockDim.x + threadIdx.x;

      return threadId;
    }
    </code></pre> <br>

    <p>2D grid of 1D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_2D_1D() {

      int blockId = blockIdx.x + blockIdx.y * gridDim.x;

      int threadId = blockId * blockDim.x + threadIdx.x;

      return threadId;
    }
    </code></pre> <br>

    <p>2D grid of 2D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_2D_2D() {

      int blockId = blockIdx.x + blockIdx.y * gridDim.x;

      int threadId = blockId * (blockDim.x * blockDim.y)
                    + (threadIdx.y * blockDim.x) + threadIdx.x;

      retrun threadId;
    }
    </code></pre> <br>

    <p>2D grid of 3D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_2D_3D() {

      int blockId = blockIdx.x + blockIdx.y * gridDim.x;

      int threadId = blockId * (blockDim.x * blockDim.y * blockDim.z)
                    + (threadIdx.z * (blockDim.x * blockDim.y)
                    + (threadIdx.y * blockDim.x) + threadIdx.x;

      return threadId;
    }
    </code></pre> <br>

    <p>3D grid of 1D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_3D_1D() {

      int blockId = blockIdx.x + blockIdx.y * gridDim.x
                   + gridDim.x * gridDim.y * blockIdx.z;

      int threadId = blockId * blockDim.x + threadIdx.x;

      return threadId;
    }
    </code></pre> <br>

    <p>3D grid of 2D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_3D_2D() {

      int blockId = blockIdx.x + blockIdx.y * gridDim.x
                   + gridDim.x * gridDim.y * blockIdx.z;

      int threadId = blockId * (blockDim.x * blockDim.y)
                    + (threadIdx.y * blockDim.x) + threadIdx.x;

      return threadId;
    }
    </code></pre> <br>

    <p>3D grid of 3D blocks</p>
    <pre style="white-space: pre-wrap; padding: 0px 0px;"><code data-language="c">
    __device__ int threadId_3D_3D() {

      int blockId = blockIdx.x + blockIdx.y * gridDim.x
                   + gridDim.x * gridDim.y * blockIdx.z;

      int threadId = blockId * (blockDim.x * blockDim.y * blockDim.z)
                    + (threadIdx.z * (blockDim.x * blockDim.y))
                    + (threadIdx.y * blockDim.x) + threadId.x;

      return threadId;
    }
    </code></pre>

    <hr />

    <footer><span>&copy;</span> 2024 Dayalan Saravanan</footer>

  </body>

</html>
